#+TITLE: 拜占庭将军问题
#+AUTHOR: PugnaHAN
#+EMAIL: justin_victory@hotmail.com
#+STARTUP: indent
#+DATE: <2016-12-03 周六>
#+OPTIONS: toc:nil

* 前言
  在看拜占庭问题之前，我们要想想为什么我们需要研究这个问题。首先，我们先回顾下比特币区块的生成过程：所有的矿工同时计算哈希值，当获取到符合条件的哈希时通知其他矿工，其他矿工验证，若成功则接受且在刚生成区块的条件下进行下一次的哈希计算。仔细观察我们会发现，所有的矿工其实彼此是相互孤立的，但是为了让区块链正常增长有必要使其行动一致。而该问题恰恰是拜占庭将军问题需要解决的。因此，在研究区块链的共识算法之前，我们有必要先认识下什么叫做拜占庭将军问题。
** TODO Add image for generating a block
   DEADLINE: <2016-12-05 周一>

* 概述
   根据[[http://duanple.blog.163.com/blog/static/7097176720112643946178/][这篇译文]]， 拜占庭将军问题其实是来源于中国将军问题（两军问题），其描述大概是：有两只军队要进攻一个国家，但是只有在同时进攻才能成功，因此其行动必须获取一致性。但是，问题在于他们的通讯方式只有信使，且信使可能会被截杀而无法到达，那么如何才能保证行动一致呢？不过Lamport扩展并修改了这个问题：指挥一组将军来围困拜占庭帝国，不过拜占庭帝国非常强大，必须要要有半数以上（如果是10支军队就是至少10/2 + 1 = 6支）军队同时进攻才能够攻破。不过两只军队不能驻扎在一起（我们可以理解为拜占庭帝国有地利，导致军队只能分散驻扎），且只能通过信使通信（信使一定能够到达且传递正确的信息）。除此之外，将军中存在叛徒，其可能会不进攻或者发布错误的消息。那么如何才能保证行动的一致性呢？其实认真想想，对于我们中国人来说，用春秋战国时期的例子更好理解。齐楚燕赵韩魏秦，我们认为秦国是拜占庭帝国，而其他国家是进攻的将军们。那么这个问题便变成了六国联军怎么才能行动一致的问题。
** 两军问题
   我们回过头来思考下两军问题（虽然是拜占庭将军问题的来源，不过二者解决的问题不同），我们称两军分别为A和B。那么整个通信过程便是：A先传递一个消息给B说明天早上五点攻打，但是由于无法确认B是否收到消息，A需要B的一个回执来保证。假设B收到消息然后发送回执给A，但是B又无法确认A是否收到回执而要求A回复一个回执。由于通信信道的不稳定性导致该循环会持续下去。因此，两军问题根本上是要求建立一个可靠安全的连接的问题，因为只要可以保证通信信使一定能够到达对方，那么其实只需要通信一次就够了。但是，并不存在这一通信渠道，因此只能通过多次握手来尽可能降低通信失效的概率，比如TCP链接。（这是我自己的推断，如果错了请指出！）
** 两军问题 vs 拜占庭将军问题 
   虽然二者都是要取得行动一致性，不过两军问题在于建立可靠连接，而拜占庭将军问题则在于在有叛徒的前提下依然使得系统能够行动一致，而非建立可靠通信，因为我们认为通信是可靠无误的。


